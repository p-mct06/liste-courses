<!DOCTYPE html>

<html lang="fr">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Liste de Courses Familiale</title>

    <style>

        * {

            margin: 0;

            padding: 0;

            box-sizing: border-box;

        }



        body {

            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

            min-height: 100vh;

            padding: 20px;

        }



        .container {

            max-width: 600px;

            margin: 0 auto;

            background: rgba(255, 255, 255, 0.95);

            backdrop-filter: blur(10px);

            border-radius: 20px;

            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);

            overflow: hidden;

        }



        .header {

            background: linear-gradient(45deg, #ff6b6b, #feca57);

            padding: 30px 20px;

            text-align: center;

            color: white;

        }



        .header h1 {

            font-size: 28px;

            margin-bottom: 10px;

            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);

        }



        .header p {

            opacity: 0.9;

            font-size: 16px;

        }



        .content {

            padding: 30px 20px;

        }



        .add-item-form {

            display: flex;

            flex-direction: column;

            gap: 15px;

            margin-bottom: 30px;

            padding: 25px;

            background: linear-gradient(135deg, #f8f9fa, #e9ecef);

            border-radius: 15px;

            border: 2px solid transparent;

            background-clip: padding-box;

            position: relative;

        }



        .add-item-form::before {

            content: '';

            position: absolute;

            inset: 0;

            padding: 2px;

            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);

            border-radius: 15px;

            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);

            mask-composite: exclude;

            z-index: -1;

        }



        .form-group {

            display: flex;

            flex-direction: column;

            gap: 8px;

        }



        .form-row {

            display: flex;

            gap: 10px;

        }



        .form-row .form-group {

            flex: 1;

        }



        label {

            font-weight: 600;

            color: #333;

            font-size: 14px;

        }



        input, select {

            padding: 12px 15px;

            border: 2px solid #e0e0e0;

            border-radius: 10px;

            font-size: 16px;

            transition: all 0.3s ease;

            background: white;

        }



        input:focus, select:focus {

            outline: none;

            border-color: #667eea;

            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);

            transform: translateY(-2px);

        }



        .btn {

            padding: 12px 25px;

            border: none;

            border-radius: 10px;

            font-size: 16px;

            font-weight: 600;

            cursor: pointer;

            transition: all 0.3s ease;

            text-transform: uppercase;

            letter-spacing: 0.5px;

        }



        .btn-primary {

            background: linear-gradient(45deg, #667eea, #764ba2);

            color: white;

        }



        .btn-primary:hover {

            transform: translateY(-3px);

            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);

        }



        .btn-secondary {

            background: linear-gradient(45deg, #ff6b6b, #feca57);

            color: white;

            font-size: 12px;

            padding: 8px 15px;

        }



        .btn-danger {

            background: linear-gradient(45deg, #ff4757, #ff3838);

            color: white;

            font-size: 12px;

            padding: 8px 15px;

        }



        .filters {

            display: flex;

            gap: 10px;

            margin-bottom: 25px;

            flex-wrap: wrap;

        }



        .filter-btn {

            padding: 8px 16px;

            border: 2px solid #e0e0e0;

            background: white;

            border-radius: 20px;

            cursor: pointer;

            transition: all 0.3s ease;

            font-size: 14px;

            font-weight: 500;

        }



        .filter-btn.active {

            background: linear-gradient(45deg, #667eea, #764ba2);

            color: white;

            border-color: transparent;

            transform: scale(1.05);

        }



        .shopping-list {

            display: flex;

            flex-direction: column;

            gap: 15px;

        }



        .list-item {

            background: white;

            padding: 20px;

            border-radius: 15px;

            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);

            border-left: 5px solid #667eea;

            transition: all 0.3s ease;

            position: relative;

            overflow: hidden;

        }



        .list-item::before {

            content: '';

            position: absolute;

            top: 0;

            left: 0;

            width: 100%;

            height: 100%;

            background: linear-gradient(45deg, transparent, rgba(102, 126, 234, 0.05), transparent);

            transform: translateX(-100%);

            transition: transform 0.6s;

        }



        .list-item:hover::before {

            transform: translateX(100%);

        }



        .list-item:hover {

            transform: translateY(-5px);

            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);

        }



        .list-item.checked {

            opacity: 0.6;

            background: #f8f9fa;

            border-left-color: #28a745;

        }



        .list-item.checked .item-name {

            text-decoration: line-through;

        }



        .item-header {

            display: flex;

            justify-content: space-between;

            align-items: flex-start;

            margin-bottom: 10px;

        }



        .item-info {

            flex: 1;

        }



        .item-name {

            font-size: 18px;

            font-weight: 600;

            color: #333;

            margin-bottom: 5px;

        }



        .item-details {

            display: flex;

            gap: 15px;

            font-size: 14px;

            color: #666;

            flex-wrap: wrap;

        }



        .item-tag {

            background: linear-gradient(45deg, #ff6b6b, #feca57);

            color: white;

            padding: 4px 12px;

            border-radius: 15px;

            font-size: 12px;

            font-weight: 500;

        }



        .item-actions {

            display: flex;

            gap: 8px;

            flex-direction: column;

        }



        .checkbox {

            width: 24px;

            height: 24px;

            cursor: pointer;

            margin-bottom: 10px;

        }



        .empty-state {

            text-align: center;

            padding: 60px 20px;

            color: #666;

        }



        .empty-state img {

            width: 120px;

            opacity: 0.5;

            margin-bottom: 20px;

        }



        @media (max-width: 768px) {

            .form-row {

                flex-direction: column;

            }

            

            .filters {

                justify-content: center;

            }

            

            .item-actions {

                flex-direction: row;

                align-items: center;

            }

        }



        .stats {

            display: flex;

            justify-content: space-around;

            margin-bottom: 20px;

            padding: 20px;

            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);

            border-radius: 15px;

        }



        .stat {

            text-align: center;

        }



        .stat-number {

            font-size: 24px;

            font-weight: bold;

            color: #667eea;

        }



        .stat-label {

            font-size: 12px;

            color: #666;

            text-transform: uppercase;

        }

    </style>

</head>

<body>

    <div class="container">

        <div class="header">

            <h1>üõí Liste de Courses</h1>

            <p>G√©rez vos courses en famille</p>

        </div>

        

        <div class="content">

            <div class="stats" id="stats">

                <div class="stat">

                    <div class="stat-number" id="totalItems">0</div>

                    <div class="stat-label">Articles</div>

                </div>

                <div class="stat">

                    <div class="stat-number" id="completedItems">0</div>

                    <div class="stat-label">Coch√©s</div>

                </div>

                <div class="stat">

                    <div class="stat-number" id="remainingItems">0</div>

                    <div class="stat-label">Restants</div>

                </div>

            </div>



            <form class="add-item-form" id="addItemForm">

                <div class="form-group">

                    <label for="itemName">Nom de l'article</label>

                    <input type="text" id="itemName" required placeholder="Ex: Lait, Pain, Pommes...">

                </div>

                

                <div class="form-row">

                    <div class="form-group">

                        <label for="itemQuantity">Quantit√©</label>

                        <input type="text" id="itemQuantity" placeholder="Ex: 2, 1kg, 500g...">

                    </div>

                    <div class="form-group">

                        <label for="itemCategory">Rayon</label>

                        <select id="itemCategory">

                            <option value="Fruits & L√©gumes">ü•ï Fruits & L√©gumes</option>

                            <option value="Boucherie">ü•© Boucherie</option>

                            <option value="Poissonnerie">üêü Poissonnerie</option>

                            <option value="Cr√©merie">üßÄ Cr√©merie</option>

                            <option value="√âpicerie">ü•´ √âpicerie</option>

                            <option value="Surgel√©s">üßä Surgel√©s</option>

                            <option value="Boissons">ü•§ Boissons</option>

                            <option value="Hygi√®ne">üß¥ Hygi√®ne</option>

                            <option value="Entretien">üßΩ Entretien</option>

                            <option value="Autre">üì¶ Autre</option>

                        </select>

                    </div>

                </div>

                

                <button type="submit" class="btn btn-primary">Ajouter √† la liste</button>

            </form>



            <div class="filters">

                <button class="filter-btn active" data-filter="all">Tous</button>

                <button class="filter-btn" data-filter="Fruits & L√©gumes">ü•ï Fruits & L√©gumes</button>

                <button class="filter-btn" data-filter="Boucherie">ü•© Boucherie</button>

                <button class="filter-btn" data-filter="Cr√©merie">üßÄ Cr√©merie</button>

                <button class="filter-btn" data-filter="√âpicerie">ü•´ √âpicerie</button>

                <button class="filter-btn" data-filter="Autre">üì¶ Autre</button>

            </div>



            <div class="shopping-list" id="shoppingList">

                <div class="empty-state">

                    <div style="font-size: 60px; margin-bottom: 20px;">üõí</div>

                    <h3>Votre liste est vide</h3>

                    <p>Ajoutez vos premiers articles ci-dessus !</p>

                </div>

            </div>

        </div>

    </div>



    <script>

        class ShoppingListApp {

            constructor() {

                this.items = this.loadItems();

                this.currentFilter = 'all';

                this.editingItem = null;

                this.currentUser = null;

                this.isAdmin = false;

                this.authorizedUsers = this.loadAuthorizedUsers();

                this.adminEmail = 'mouchet.family@gmail.com';

                this.customCategories = this.loadCustomCategories();

                this.defaultCategories = [

                    { name: 'Fruits & L√©gumes', icon: 'ü•ï' },

                    { name: 'Boucherie', icon: 'ü•©' },

                    { name: 'Poissonnerie', icon: 'üêü' },

                    { name: 'Cr√©merie', icon: 'üßÄ' },

                    { name: '√âpicerie', icon: 'ü•´' },

                    { name: 'Surgel√©s', icon: 'üßä' },

                    { name: 'Boissons', icon: 'ü•§' },

                    { name: 'Hygi√®ne', icon: 'üß¥' },

                    { name: 'Entretien', icon: 'üßΩ' },

                    { name: 'Autre', icon: 'üì¶' }

                ];

                this.init();

            }



            init() {

                this.checkAuthentication();

            }



            checkAuthentication() {

                // V√©rifier si l'utilisateur est d√©j√† connect√©

                const savedUser = this.getSavedUser();

                if (savedUser && this.isUserAuthorized(savedUser)) {

                    this.currentUser = savedUser;

                    this.isAdmin = savedUser === this.adminEmail;

                    this.showMainApp();

                } else {

                    this.showLoginForm();

                }

            }



            showLoginForm() {

                document.querySelector('.container').innerHTML = `

                    <div class="header">

                        <h1>üîê Connexion</h1>

                        <p>Acc√®s r√©serv√© aux membres de la famille</p>

                    </div>

                    

                    <div class="content">

                        <form class="add-item-form" id="loginForm">

                            <div class="form-group">

                                <label for="userEmail">Adresse email</label>

                                <input type="email" id="userEmail" required placeholder="votre@email.com" autocomplete="email">

                            </div>

                            

                            <button type="submit" class="btn btn-primary">Se connecter</button>

                            

                            <div id="loginError" style="color: #ff4757; text-align: center; margin-top: 15px; display: none;">

                                <strong>‚ùå Acc√®s refus√©</strong><br>

                                Votre email n'est pas autoris√©. Contactez l'administrateur.

                            </div>

                        </form>

                        

                        <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 15px; text-align: center;">

                            <h3 style="color: #666; margin-bottom: 15px;">üë• Membres autoris√©s</h3>

                            <div id="authorizedUsersList">

                                ${this.authorizedUsers.map(user => `

                                    <div style="padding: 8px; background: white; margin: 5px 0; border-radius: 8px; border-left: 4px solid ${user === this.adminEmail ? '#ff6b6b' : '#667eea'};">

                                        ${user} ${user === this.adminEmail ? '(Admin)' : ''}

                                    </div>

                                `).join('')}

                            </div>

                        </div>

                    </div>

                `;



                document.getElementById('loginForm').addEventListener('submit', (e) => {

                    e.preventDefault();

                    this.handleLogin();

                });

            }



            showMainApp() {

                document.querySelector('.container').innerHTML = `

                    <div class="header">

                        <h1>üõí Liste de Courses</h1>

                        <p>G√©rez vos courses en famille</p>

                        <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">

                            <span style="background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 20px; font-size: 14px;">

                                üë§ ${this.currentUser} ${this.isAdmin ? '(Admin)' : ''}

                            </span>

                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">

                                <button class="btn" style="background: rgba(255,255,255,0.2); color: white; font-size: 12px; padding: 8px 15px;" onclick="app.showCategoryManagement()">üè™ G√©rer rayons</button>

                                ${this.isAdmin ? '<button class="btn" style="background: rgba(255,255,255,0.2); color: white; font-size: 12px; padding: 8px 15px;" onclick="app.showUserManagement()">üë• G√©rer utilisateurs</button>' : ''}

                                <button class="btn" style="background: rgba(255,255,255,0.2); color: white; font-size: 12px; padding: 8px 15px;" onclick="app.logout()">üö™ D√©connexion</button>

                            </div>

                        </div>

                    </div>

                    

                    <div class="content">

                        <div class="stats" id="stats">

                            <div class="stat">

                                <div class="stat-number" id="totalItems">0</div>

                                <div class="stat-label">Articles</div>

                            </div>

                            <div class="stat">

                                <div class="stat-number" id="completedItems">0</div>

                                <div class="stat-label">Coch√©s</div>

                            </div>

                            <div class="stat">

                                <div class="stat-number" id="remainingItems">0</div>

                                <div class="stat-label">Restants</div>

                            </div>

                        </div>



                        <form class="add-item-form" id="addItemForm">

                            <div class="form-group">

                                <label for="itemName">Nom de l'article</label>

                                <input type="text" id="itemName" required placeholder="Ex: Lait, Pain, Pommes...">

                            </div>

                            

                            <div class="form-row">

                                <div class="form-group">

                                    <label for="itemQuantity">Quantit√©</label>

                                    <input type="text" id="itemQuantity" placeholder="Ex: 2, 1kg, 500g...">

                                </div>

                                <div class="form-group">

                                    <label for="itemCategory">Rayon</label>

                                    <select id="itemCategory">

                                        ${this.getAllCategories().map(cat => 

                                            `<option value="${cat.name}">${cat.icon} ${cat.name}</option>`

                                        ).join('')}

                                    </select>

                                </div>

                            </div>

                            

                            <button type="submit" class="btn btn-primary">Ajouter √† la liste</button>

                        </form>



                        <div class="filters">

                            <button class="filter-btn active" data-filter="all">Tous</button>

                            ${this.getAllCategories().slice(0, 5).map(cat => 

                                `<button class="filter-btn" data-filter="${cat.name}">${cat.icon} ${cat.name}</button>`

                            ).join('')}

                            ${this.getAllCategories().length > 5 ? '<button class="filter-btn" data-filter="more">+ Plus</button>' : ''}

                        </div>



                        <div class="shopping-list" id="shoppingList">

                            <div class="empty-state">

                                <div style="font-size: 60px; margin-bottom: 20px;">üõí</div>

                                <h3>Votre liste est vide</h3>

                                <p>Ajoutez vos premiers articles ci-dessus !</p>

                            </div>

                        </div>

                    </div>

                `;



                this.bindEvents();

                this.render();

                this.updateStats();

            }



            showCategoryManagement() {

                document.querySelector('.container').innerHTML = `

                    <div class="header">

                        <h1>üè™ Gestion des Rayons</h1>

                        <p>Personnalisez vos cat√©gories</p>

                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white; font-size: 12px; padding: 8px 15px; margin-top: 15px;" onclick="app.showMainApp()">‚Üê Retour √† la liste</button>

                    </div>

                    

                    <div class="content">

                        <form class="add-item-form" id="addCategoryForm">

                            <h3 style="margin-bottom: 20px; color: #333;">‚ûï Ajouter un nouveau rayon</h3>

                            <div class="form-row">

                                <div class="form-group">

                                    <label for="newCategoryName">Nom du rayon</label>

                                    <input type="text" id="newCategoryName" required placeholder="Ex: Boulangerie, Jardinerie...">

                                </div>

                                <div class="form-group">

                                    <label for="newCategoryIcon">Ic√¥ne (emoji)</label>

                                    <input type="text" id="newCategoryIcon" placeholder="üçû" maxlength="2" style="text-align: center;">

                                </div>

                            </div>

                            <button type="submit" class="btn btn-primary">Cr√©er le rayon</button>

                        </form>



                        <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-top: 30px;">

                            <h3 style="margin-bottom: 20px; color: #333;">üè™ Rayons par d√©faut</h3>

                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">

                                ${this.defaultCategories.map(cat => `

                                    <div style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid #667eea;">

                                        <span style="font-size: 20px; margin-right: 10px;">${cat.icon}</span>

                                        <span>${cat.name}</span>

                                        <span style="margin-left: auto; color: #888; font-size: 12px;">Par d√©faut</span>

                                    </div>

                                `).join('')}

                            </div>

                        </div>



                        ${this.customCategories.length > 0 ? `

                            <div style="background: #f0f8ff; padding: 25px; border-radius: 15px; margin-top: 20px;">

                                <h3 style="margin-bottom: 20px; color: #333;">‚ú® Rayons personnalis√©s</h3>

                                <div id="customCategoriesList">

                                    ${this.customCategories.map(cat => `

                                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: white; margin: 10px 0; border-radius: 10px; border-left: 4px solid #4ecdc4;">

                                            <div style="display: flex; align-items: center;">

                                                <span style="font-size: 20px; margin-right: 15px;">${cat.icon}</span>

                                                <div>

                                                    <strong>${cat.name}</strong>

                                                    <div style="font-size: 12px; color: #666;">Cr√©√© par ${cat.createdBy || 'Utilisateur'}</div>

                                                </div>

                                            </div>

                                            <button class="btn btn-danger" onclick="app.removeCustomCategory('${cat.name}')">Supprimer</button>

                                        </div>

                                    `).join('')}

                                </div>

                            </div>

                        ` : ''}



                        <div id="categoryMessage" style="text-align: center; margin-top: 20px; padding: 15px; border-radius: 10px; display: none;"></div>

                    </div>

                `;



                document.getElementById('addCategoryForm').addEventListener('submit', (e) => {

                    e.preventDefault();

                    this.addCustomCategory();

                });

            }



            addCustomCategory() {

                const name = document.getElementById('newCategoryName').value.trim();

                const icon = document.getElementById('newCategoryIcon').value.trim() || 'üì¶';

                

                if (!name) return;

                

                // V√©rifier si la cat√©gorie existe d√©j√†

                const allCategories = this.getAllCategories();

                if (allCategories.some(cat => cat.name.toLowerCase() === name.toLowerCase())) {

                    this.showCategoryMessage('‚ùå Ce rayon existe d√©j√†', 'error');

                    return;

                }



                const newCategory = {

                    name: name,

                    icon: icon,

                    createdBy: this.currentUser,

                    createdAt: new Date().toLocaleDateString('fr-FR')

                };



                this.customCategories.push(newCategory);

                this.saveCustomCategories();

                this.showCategoryMessage('‚úÖ Rayon cr√©√© avec succ√®s', 'success');

                

                document.getElementById('newCategoryName').value = '';

                document.getElementById('newCategoryIcon').value = '';

                

                // Rafra√Æchir la liste

                setTimeout(() => {

                    this.showCategoryManagement();

                }, 1500);

            }



            removeCustomCategory(categoryName) {

                if (confirm(`√ätes-vous s√ªr de vouloir supprimer le rayon "${categoryName}" ?\n\nAttention: Cette action d√©placera tous les articles de ce rayon vers "Autre".`)) {

                    // D√©placer les articles existants vers "Autre"

                    this.items.forEach(item => {

                        if (item.category === categoryName) {

                            item.category = 'Autre';

                        }

                    });

                    

                    // Supprimer la cat√©gorie personnalis√©e

                    this.customCategories = this.customCategories.filter(cat => cat.name !== categoryName);

                    this.saveCustomCategories();

                    this.saveItems();

                    

                    this.showCategoryMessage('‚úÖ Rayon supprim√© et articles d√©plac√©s', 'success');

                    

                    // Rafra√Æchir la liste

                    setTimeout(() => {

                        this.showCategoryManagement();

                    }, 1500);

                }

            }



            getAllCategories() {

                return [...this.defaultCategories, ...this.customCategories];

            }



            showCategoryMessage(message, type) {

                const messageDiv = document.getElementById('categoryMessage');

                messageDiv.textContent = message;

                messageDiv.style.display = 'block';

                messageDiv.style.background = type === 'success' ? '#d4edda' : '#f8d7da';

                messageDiv.style.color = type === 'success' ? '#155724' : '#721c24';

                messageDiv.style.border = `1px solid ${type === 'success' ? '#c3e6cb' : '#f5c6cb'}`;

                

                setTimeout(() => {

                    messageDiv.style.display = 'none';

                }, 3000);

            }



            loadCustomCategories() {

                // Dans un environnement r√©el, charger depuis la base de donn√©es

                // Ici, nous retournons des cat√©gories d'exemple

                return [

                    {

                        name: 'Boulangerie',

                        icon: 'üçû',

                        createdBy: 'mouchet.family@gmail.com',

                        createdAt: new Date().toLocaleDateString('fr-FR')

                    }

                ];

            }



            saveCustomCategories() {

                // Dans un environnement r√©el, sauvegarder en base de donn√©es

                console.log('Cat√©gories personnalis√©es sauvegard√©es:', this.customCategories);

            }

                if (!this.isAdmin) return;



                document.querySelector('.container').innerHTML = `

                    <div class="header">

                        <h1>üë• Gestion des Utilisateurs</h1>

                        <p>Administrer les acc√®s famille</p>

                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white; font-size: 12px; padding: 8px 15px; margin-top: 15px;" onclick="app.showMainApp()">‚Üê Retour √† la liste</button>

                    </div>

                    

                    <div class="content">

                        <form class="add-item-form" id="addUserForm">

                            <div class="form-group">

                                <label for="newUserEmail">Ajouter un nouvel utilisateur</label>

                                <input type="email" id="newUserEmail" required placeholder="email@exemple.com">

                            </div>

                            <button type="submit" class="btn btn-primary">Ajouter l'utilisateur</button>

                        </form>



                        <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-top: 30px;">

                            <h3 style="margin-bottom: 20px; color: #333;">üìã Utilisateurs autoris√©s</h3>

                            <div id="usersList">

                                ${this.authorizedUsers.map(user => `

                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: white; margin: 10px 0; border-radius: 10px; border-left: 4px solid ${user === this.adminEmail ? '#ff6b6b' : '#667eea'};">

                                        <div>

                                            <strong>${user}</strong>

                                            ${user === this.adminEmail ? '<span style="color: #ff6b6b; font-size: 12px;"> (Administrateur)</span>' : ''}

                                        </div>

                                        ${user !== this.adminEmail ? `<button class="btn btn-danger" onclick="app.removeUser('${user}')">Supprimer</button>` : '<span style="color: #666; font-size: 12px;">Admin permanent</span>'}

                                    </div>

                                `).join('')}

                            </div>

                        </div>



                        <div id="userMessage" style="text-align: center; margin-top: 20px; padding: 15px; border-radius: 10px; display: none;"></div>

                    </div>

                `;



                document.getElementById('addUserForm').addEventListener('submit', (e) => {

                    e.preventDefault();

                    this.addUser();

                });

            }



            handleLogin() {

                const email = document.getElementById('userEmail').value.trim().toLowerCase();

                

                if (this.isUserAuthorized(email)) {

                    this.currentUser = email;

                    this.isAdmin = email === this.adminEmail;

                    this.saveUser(email);

                    this.showMainApp();

                } else {

                    document.getElementById('loginError').style.display = 'block';

                    setTimeout(() => {

                        document.getElementById('loginError').style.display = 'none';

                    }, 5000);

                }

            }



            addUser() {

                const email = document.getElementById('newUserEmail').value.trim().toLowerCase();

                

                if (!email) return;

                

                if (this.authorizedUsers.includes(email)) {

                    this.showUserMessage('‚ùå Cet utilisateur est d√©j√† autoris√©', 'error');

                    return;

                }



                this.authorizedUsers.push(email);

                this.saveAuthorizedUsers();

                this.showUserMessage('‚úÖ Utilisateur ajout√© avec succ√®s', 'success');

                document.getElementById('newUserEmail').value = '';

                

                // Rafra√Æchir la liste

                setTimeout(() => {

                    this.showUserManagement();

                }, 1500);

            }



            removeUser(email) {

                if (email === this.adminEmail) return;

                

                if (confirm(`√ätes-vous s√ªr de vouloir supprimer l'acc√®s de ${email} ?`)) {

                    this.authorizedUsers = this.authorizedUsers.filter(user => user !== email);

                    this.saveAuthorizedUsers();

                    this.showUserMessage('‚úÖ Utilisateur supprim√©', 'success');

                    

                    // Rafra√Æchir la liste

                    setTimeout(() => {

                        this.showUserManagement();

                    }, 1500);

                }

            }



            showUserMessage(message, type) {

                const messageDiv = document.getElementById('userMessage');

                messageDiv.textContent = message;

                messageDiv.style.display = 'block';

                messageDiv.style.background = type === 'success' ? '#d4edda' : '#f8d7da';

                messageDiv.style.color = type === 'success' ? '#155724' : '#721c24';

                messageDiv.style.border = `1px solid ${type === 'success' ? '#c3e6cb' : '#f5c6cb'}`;

                

                setTimeout(() => {

                    messageDiv.style.display = 'none';

                }, 3000);

            }



            logout() {

                if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {

                    this.currentUser = null;

                    this.isAdmin = false;

                    this.clearSavedUser();

                    this.showLoginForm();

                }

            }



            isUserAuthorized(email) {

                return this.authorizedUsers.includes(email.toLowerCase());

            }



            loadAuthorizedUsers() {

                // Dans un environnement r√©el, ces donn√©es viendraient d'une base de donn√©es

                // Ici nous initialisons avec l'admin et quelques utilisateurs d'exemple

                return [

                    'mouchet.family@gmail.com',

                    // Ajoutez ici d'autres emails autoris√©s par d√©faut si n√©cessaire

                ];

            }



            saveAuthorizedUsers() {

                // Dans un environnement r√©el, sauvegarder en base de donn√©es

                console.log('Utilisateurs autoris√©s sauvegard√©s:', this.authorizedUsers);

            }



            getSavedUser() {

                // Dans un environnement r√©el, v√©rifier la session/token

                // Simulation de r√©cup√©ration d'utilisateur sauvegard√©

                return null; // Forcer la connexion √† chaque fois pour la d√©mo

            }



            saveUser(email) {

                // Dans un environnement r√©el, sauvegarder la session/token

                console.log('Utilisateur connect√©:', email);

            }



            clearSavedUser() {

                // Dans un environnement r√©el, supprimer la session/token

                console.log('Session utilisateur supprim√©e');

            }



            bindEvents() {

                document.getElementById('addItemForm').addEventListener('submit', (e) => {

                    e.preventDefault();

                    this.addItem();

                });



                document.querySelectorAll('.filter-btn').forEach(btn => {

                    btn.addEventListener('click', (e) => {

                        this.setFilter(e.target.dataset.filter);

                    });

                });

            }



            addItem() {

                const name = document.getElementById('itemName').value.trim();

                const quantity = document.getElementById('itemQuantity').value.trim();

                const category = document.getElementById('itemCategory').value;



                if (!name) return;



                if (this.editingItem) {

                    // Mode √©dition

                    const item = this.items.find(item => item.id === this.editingItem);

                    if (item) {

                        item.name = name;

                        item.quantity = quantity;

                        item.category = category;

                    }

                    this.editingItem = null;

                    document.querySelector('.btn-primary').textContent = 'Ajouter √† la liste';

                } else {

                    // Nouveau item

                    const newItem = {

                        id: Date.now(),

                        name: name,

                        quantity: quantity,

                        category: category,

                        completed: false,

                        addedBy: this.currentUser || 'Utilisateur',

                        addedAt: new Date().toLocaleDateString('fr-FR')

                    };

                    this.items.push(newItem);

                }



                this.saveItems();

                this.render();

                this.updateStats();

                this.clearForm();

            }



            editItem(id) {

                const item = this.items.find(item => item.id === id);

                if (!item) return;



                document.getElementById('itemName').value = item.name;

                document.getElementById('itemQuantity').value = item.quantity;

                document.getElementById('itemCategory').value = item.category;

                

                this.editingItem = id;

                document.querySelector('.btn-primary').textContent = 'Modifier l\'article';

                

                // Scroll vers le formulaire

                document.getElementById('addItemForm').scrollIntoView({ behavior: 'smooth' });

            }



            deleteItem(id) {

                if (confirm('√ätes-vous s√ªr de vouloir supprimer cet article ?')) {

                    this.items = this.items.filter(item => item.id !== id);

                    this.saveItems();

                    this.render();

                    this.updateStats();

                }

            }



            toggleItem(id) {

                const item = this.items.find(item => item.id === id);

                if (item) {

                    item.completed = !item.completed;

                    this.saveItems();

                    this.render();

                    this.updateStats();

                }

            }



            setFilter(filter) {

                this.currentFilter = filter;

                

                document.querySelectorAll('.filter-btn').forEach(btn => {

                    btn.classList.remove('active');

                });

                document.querySelector(`[data-filter="${filter}"]`).classList.add('active');

                

                this.render();

            }



            getFilteredItems() {

                if (this.currentFilter === 'all') {

                    return this.items;

                }

                return this.items.filter(item => item.category === this.currentFilter);

            }



            render() {

                const listContainer = document.getElementById('shoppingList');

                const filteredItems = this.getFilteredItems();



                if (filteredItems.length === 0) {

                    listContainer.innerHTML = `

                        <div class="empty-state">

                            <div style="font-size: 60px; margin-bottom: 20px;">üõí</div>

                            <h3>${this.currentFilter === 'all' ? 'Votre liste est vide' : 'Aucun article dans cette cat√©gorie'}</h3>

                            <p>${this.currentFilter === 'all' ? 'Ajoutez vos premiers articles ci-dessus !' : 'Changez de filtre ou ajoutez des articles'}</p>

                        </div>

                    `;

                    return;

                }



                // Grouper par cat√©gorie et trier

                const groupedItems = {};

                filteredItems.forEach(item => {

                    if (!groupedItems[item.category]) {

                        groupedItems[item.category] = [];

                    }

                    groupedItems[item.category].push(item);

                });



                let html = '';

                Object.keys(groupedItems).sort().forEach(category => {

                    const categoryItems = groupedItems[category].sort((a, b) => {

                        if (a.completed !== b.completed) {

                            return a.completed ? 1 : -1;

                        }

                        return a.name.localeCompare(b.name);

                    });



                    categoryItems.forEach(item => {

                        html += `

                            <div class="list-item ${item.completed ? 'checked' : ''}" data-category="${item.category}">

                                <div class="item-header">

                                    <div class="item-info">

                                        <div class="item-name">${item.name}</div>

                                        <div class="item-details">

                                            ${item.quantity ? `<span><strong>Quantit√©:</strong> ${item.quantity}</span>` : ''}

                                            <span class="item-tag">${this.getCategoryWithIcon(item.category)}</span>

                                            ${item.addedBy ? `<span style="font-size: 12px; color: #888;">Ajout√© par ${item.addedBy}</span>` : ''}

                                        </div>

                                    </div>

                                    <div class="item-actions">

                                        <input type="checkbox" class="checkbox" ${item.completed ? 'checked' : ''} 

                                               onchange="app.toggleItem(${item.id})">

                                        <button class="btn btn-secondary" onclick="app.editItem(${item.id})">‚úèÔ∏è</button>

                                        <button class="btn btn-danger" onclick="app.deleteItem(${item.id})">üóëÔ∏è</button>

                                    </div>

                                </div>

                            </div>

                        `;

                    });

                });



                listContainer.innerHTML = html;

            }



            updateStats() {

                const total = this.items.length;

                const completed = this.items.filter(item => item.completed).length;

                const remaining = total - completed;



                document.getElementById('totalItems').textContent = total;

                document.getElementById('completedItems').textContent = completed;

                document.getElementById('remainingItems').textContent = remaining;

            }



            getCategoryWithIcon(categoryName) {

                const category = this.getAllCategories().find(cat => cat.name === categoryName);

                return category ? `${category.icon} ${category.name}` : categoryName;

            }



            clearForm() {

                document.getElementById('itemName').value = '';

                document.getElementById('itemQuantity').value = '';

                document.getElementById('itemCategory').value = this.defaultCategories[0].name;

            }



            saveItems() {

                // Dans un environnement r√©el, vous envoyeriez les donn√©es vers un serveur

                // Ici, nous simulons la sauvegarde en m√©moire

                console.log('Donn√©es sauvegard√©es:', this.items);

            }



            loadItems() {

                // Dans un environnement r√©el, vous chargeriez les donn√©es depuis un serveur

                // Ici, nous retournons des donn√©es d'exemple

                return [

                    {

                        id: 1,

                        name: 'Lait',

                        quantity: '1L',

                        category: 'Cr√©merie',

                        completed: false,

                        addedBy: 'Papa',

                        addedAt: new Date().toLocaleDateString('fr-FR')

                    },

                    {

                        id: 2,

                        name: 'Pommes',

                        quantity: '2kg',

                        category: 'Fruits & L√©gumes',

                        completed: true,

                        addedBy: 'Maman',

                        addedAt: new Date().toLocaleDateString('fr-FR')

                    }

                ];

            }

        }



        // Initialiser l'application

        const app = new ShoppingListApp();



        // Support pour PWA (Progressive Web App)

        if ('serviceWorker' in navigator) {

            window.addEventListener('load', () => {

                navigator.serviceWorker.register('/sw.js')

                    .then(registration => console.log('SW registered'))

                    .catch(error => console.log('SW registration failed'));

            });

        }

    </script>

</body>

</html>